import json
import unittest

from rs.ai.requested_strike.handlers.temp_fight_handler import TempFightHandler
from rs.machine.state import GameState

STATE = '{"available_commands":["play","end","key","click","wait","state"],"ready_for_command":true,"in_game":true,"game_state":{"screen_type":"NONE","screen_state":{},"seed":1394488993359253936,"combat_state":{"draw_pile":[{"exhausts":false,"is_playable":true,"cost":1,"name":"Defend","id":"Defend_R","type":"SKILL","ethereal":false,"uuid":"a81cf650-bab3-4493-96bf-b9422870c645","upgrades":0,"rarity":"BASIC","has_target":false},{"exhausts":false,"is_playable":true,"cost":1,"name":"Strike","id":"Strike_R","type":"ATTACK","ethereal":false,"uuid":"3bd0abea-3b97-450e-9398-4a2e5e59101c","upgrades":0,"rarity":"BASIC","has_target":true},{"exhausts":false,"is_playable":false,"cost":2,"name":"Bash","id":"Bash","type":"ATTACK","ethereal":false,"uuid":"100d2b03-6ade-4ac1-b35a-cba889fd9241","upgrades":0,"rarity":"BASIC","has_target":true},{"exhausts":false,"is_playable":true,"cost":1,"name":"Strike","id":"Strike_R","type":"ATTACK","ethereal":false,"uuid":"1363ef9c-010d-443d-820f-93390ee76057","upgrades":0,"rarity":"BASIC","has_target":true},{"exhausts":false,"is_playable":true,"cost":1,"name":"Defend","id":"Defend_R","type":"SKILL","ethereal":false,"uuid":"82bc1e76-b45a-43ab-99cb-7447dccc9977","upgrades":0,"rarity":"BASIC","has_target":false}],"discard_pile":[{"exhausts":false,"is_playable":true,"cost":1,"name":"Strike","id":"Strike_R","type":"ATTACK","ethereal":false,"uuid":"498faa5c-a751-47cb-8ac7-7bfbc861375e","upgrades":0,"rarity":"BASIC","has_target":true},{"exhausts":false,"is_playable":true,"cost":1,"name":"Strike","id":"Strike_R","type":"ATTACK","ethereal":false,"uuid":"fd591c43-fbd7-4efa-897f-184a6a11d587","upgrades":0,"rarity":"BASIC","has_target":true},{"exhausts":false,"is_playable":true,"cost":0,"name":"Anger","id":"Anger","type":"ATTACK","ethereal":false,"uuid":"fb7e4e1c-4708-4190-83d1-0193c91f8553","upgrades":0,"rarity":"COMMON","has_target":true},{"exhausts":false,"is_playable":true,"cost":0,"name":"Anger","id":"Anger","type":"ATTACK","ethereal":false,"uuid":"023a48b2-1076-4165-8016-6f2383c37ef9","upgrades":0,"rarity":"COMMON","has_target":true}],"exhaust_pile":[],"cards_discarded_this_turn":0,"times_damaged":0,"monsters":[{"is_gone":true,"move_hits":1,"move_base_damage":5,"half_dead":false,"move_adjusted_damage":5,"max_hp":13,"intent":"ATTACK","move_id":1,"name":"Spike Slime (S)","current_hp":0,"block":0,"id":"SpikeSlime_S","powers":[]},{"is_gone":false,"move_hits":1,"move_base_damage":-1,"half_dead":false,"move_adjusted_damage":-1,"max_hp":32,"intent":"DEBUFF","move_id":4,"name":"Acid Slime (M)","current_hp":32,"block":0,"id":"AcidSlime_M","powers":[]}],"turn":1,"limbo":[],"hand":[{"exhausts":false,"is_playable":true,"cost":1,"name":"Defend","id":"Defend_R","type":"SKILL","ethereal":false,"uuid":"90a0667d-ce52-4610-8e9b-3132c0781674","upgrades":0,"rarity":"BASIC","has_target":false},{"exhausts":false,"is_playable":true,"cost":1,"name":"Defend","id":"Defend_R","type":"SKILL","ethereal":false,"uuid":"f24a2e13-648d-409c-ae47-e3b6a97dab84","upgrades":0,"rarity":"BASIC","has_target":false}],"player":{"orbs":[],"current_hp":75,"block":0,"max_hp":80,"powers":[],"energy":1}},"deck":[{"exhausts":false,"is_playable":true,"cost":1,"name":"Strike","id":"Strike_R","type":"ATTACK","ethereal":false,"uuid":"fd591c43-fbd7-4efa-897f-184a6a11d587","upgrades":0,"rarity":"BASIC","has_target":true},{"exhausts":false,"is_playable":true,"cost":1,"name":"Strike","id":"Strike_R","type":"ATTACK","ethereal":false,"uuid":"498faa5c-a751-47cb-8ac7-7bfbc861375e","upgrades":0,"rarity":"BASIC","has_target":true},{"exhausts":false,"is_playable":true,"cost":1,"name":"Strike","id":"Strike_R","type":"ATTACK","ethereal":false,"uuid":"3bd0abea-3b97-450e-9398-4a2e5e59101c","upgrades":0,"rarity":"BASIC","has_target":true},{"exhausts":false,"is_playable":true,"cost":1,"name":"Strike","id":"Strike_R","type":"ATTACK","ethereal":false,"uuid":"1363ef9c-010d-443d-820f-93390ee76057","upgrades":0,"rarity":"BASIC","has_target":true},{"exhausts":false,"is_playable":true,"cost":1,"name":"Defend","id":"Defend_R","type":"SKILL","ethereal":false,"uuid":"a81cf650-bab3-4493-96bf-b9422870c645","upgrades":0,"rarity":"BASIC","has_target":false},{"exhausts":false,"is_playable":true,"cost":1,"name":"Defend","id":"Defend_R","type":"SKILL","ethereal":false,"uuid":"90a0667d-ce52-4610-8e9b-3132c0781674","upgrades":0,"rarity":"BASIC","has_target":false},{"exhausts":false,"is_playable":true,"cost":1,"name":"Defend","id":"Defend_R","type":"SKILL","ethereal":false,"uuid":"82bc1e76-b45a-43ab-99cb-7447dccc9977","upgrades":0,"rarity":"BASIC","has_target":false},{"exhausts":false,"is_playable":true,"cost":1,"name":"Defend","id":"Defend_R","type":"SKILL","ethereal":false,"uuid":"f24a2e13-648d-409c-ae47-e3b6a97dab84","upgrades":0,"rarity":"BASIC","has_target":false},{"exhausts":false,"is_playable":false,"cost":2,"name":"Bash","id":"Bash","type":"ATTACK","ethereal":false,"uuid":"100d2b03-6ade-4ac1-b35a-cba889fd9241","upgrades":0,"rarity":"BASIC","has_target":true},{"exhausts":false,"is_playable":true,"cost":0,"name":"Anger","id":"Anger","type":"ATTACK","ethereal":false,"uuid":"023a48b2-1076-4165-8016-6f2383c37ef9","upgrades":0,"rarity":"COMMON","has_target":true}],"relics":[{"name":"Burning Blood","id":"Burning Blood","counter":-1}],"max_hp":80,"act_boss":"Slime Boss","gold":114,"action_phase":"WAITING_ON_USER","act":1,"screen_name":"NONE","room_phase":"COMBAT","is_screen_up":false,"potions":[{"requires_target":false,"can_use":false,"can_discard":false,"name":"Potion Slot","id":"Potion Slot"},{"requires_target":false,"can_use":false,"can_discard":false,"name":"Potion Slot","id":"Potion Slot"},{"requires_target":false,"can_use":false,"can_discard":false,"name":"Potion Slot","id":"Potion Slot"}],"current_hp":75,"floor":2,"ascension_level":0,"class":"IRONCLAD","map":[{"symbol":"M","children":[{"x":1,"y":1}],"x":1,"y":0,"parents":[]},{"symbol":"M","children":[{"x":3,"y":1}],"x":3,"y":0,"parents":[]},{"symbol":"M","children":[{"x":4,"y":1}],"x":4,"y":0,"parents":[]},{"symbol":"M","children":[{"x":6,"y":1}],"x":5,"y":0,"parents":[]},{"symbol":"?","children":[{"x":0,"y":2}],"x":1,"y":1,"parents":[]},{"symbol":"M","children":[{"x":4,"y":2}],"x":3,"y":1,"parents":[]},{"symbol":"M","children":[{"x":4,"y":2}],"x":4,"y":1,"parents":[]},{"symbol":"M","children":[{"x":5,"y":2}],"x":6,"y":1,"parents":[]},{"symbol":"M","children":[{"x":0,"y":3}],"x":0,"y":2,"parents":[]},{"symbol":"$","children":[{"x":3,"y":3},{"x":5,"y":3}],"x":4,"y":2,"parents":[]},{"symbol":"M","children":[{"x":5,"y":3},{"x":6,"y":3}],"x":5,"y":2,"parents":[]},{"symbol":"M","children":[{"x":1,"y":4}],"x":0,"y":3,"parents":[]},{"symbol":"M","children":[{"x":2,"y":4}],"x":3,"y":3,"parents":[]},{"symbol":"?","children":[{"x":4,"y":4}],"x":5,"y":3,"parents":[]},{"symbol":"M","children":[{"x":6,"y":4}],"x":6,"y":3,"parents":[]},{"symbol":"M","children":[{"x":1,"y":5}],"x":1,"y":4,"parents":[]},{"symbol":"M","children":[{"x":3,"y":5}],"x":2,"y":4,"parents":[]},{"symbol":"M","children":[{"x":4,"y":5},{"x":5,"y":5}],"x":4,"y":4,"parents":[]},{"symbol":"M","children":[{"x":5,"y":5}],"x":6,"y":4,"parents":[]},{"symbol":"R","children":[{"x":1,"y":6}],"x":1,"y":5,"parents":[]},{"symbol":"M","children":[{"x":2,"y":6},{"x":4,"y":6}],"x":3,"y":5,"parents":[]},{"symbol":"$","children":[{"x":4,"y":6}],"x":4,"y":5,"parents":[]},{"symbol":"M","children":[{"x":4,"y":6},{"x":5,"y":6}],"x":5,"y":5,"parents":[]},{"symbol":"?","children":[{"x":2,"y":7}],"x":1,"y":6,"parents":[]},{"symbol":"?","children":[{"x":2,"y":7}],"x":2,"y":6,"parents":[]},{"symbol":"M","children":[{"x":3,"y":7},{"x":4,"y":7}],"x":4,"y":6,"parents":[]},{"symbol":"$","children":[{"x":5,"y":7}],"x":5,"y":6,"parents":[]},{"symbol":"E","children":[{"x":1,"y":8},{"x":3,"y":8}],"x":2,"y":7,"parents":[]},{"symbol":"E","children":[{"x":4,"y":8}],"x":3,"y":7,"parents":[]},{"symbol":"M","children":[{"x":5,"y":8}],"x":4,"y":7,"parents":[]},{"symbol":"E","children":[{"x":5,"y":8}],"x":5,"y":7,"parents":[]},{"symbol":"T","children":[{"x":1,"y":9}],"x":1,"y":8,"parents":[]},{"symbol":"T","children":[{"x":2,"y":9}],"x":3,"y":8,"parents":[]},{"symbol":"T","children":[{"x":4,"y":9}],"x":4,"y":8,"parents":[]},{"symbol":"T","children":[{"x":5,"y":9},{"x":6,"y":9}],"x":5,"y":8,"parents":[]},{"symbol":"R","children":[{"x":2,"y":10}],"x":1,"y":9,"parents":[]},{"symbol":"E","children":[{"x":3,"y":10}],"x":2,"y":9,"parents":[]},{"symbol":"?","children":[{"x":4,"y":10}],"x":4,"y":9,"parents":[]},{"symbol":"R","children":[{"x":4,"y":10}],"x":5,"y":9,"parents":[]},{"symbol":"M","children":[{"x":5,"y":10}],"x":6,"y":9,"parents":[]},{"symbol":"M","children":[{"x":1,"y":11}],"x":2,"y":10,"parents":[]},{"symbol":"R","children":[{"x":3,"y":11}],"x":3,"y":10,"parents":[]},{"symbol":"?","children":[{"x":3,"y":11}],"x":4,"y":10,"parents":[]},{"symbol":"R","children":[{"x":5,"y":11}],"x":5,"y":10,"parents":[]},{"symbol":"M","children":[{"x":2,"y":12}],"x":1,"y":11,"parents":[]},{"symbol":"M","children":[{"x":2,"y":12},{"x":3,"y":12}],"x":3,"y":11,"parents":[]},{"symbol":"?","children":[{"x":6,"y":12}],"x":5,"y":11,"parents":[]},{"symbol":"R","children":[{"x":1,"y":13},{"x":2,"y":13}],"x":2,"y":12,"parents":[]},{"symbol":"?","children":[{"x":4,"y":13}],"x":3,"y":12,"parents":[]},{"symbol":"R","children":[{"x":5,"y":13},{"x":6,"y":13}],"x":6,"y":12,"parents":[]},{"symbol":"?","children":[{"x":0,"y":14}],"x":1,"y":13,"parents":[]},{"symbol":"M","children":[{"x":2,"y":14}],"x":2,"y":13,"parents":[]},{"symbol":"?","children":[{"x":4,"y":14}],"x":4,"y":13,"parents":[]},{"symbol":"?","children":[{"x":5,"y":14}],"x":5,"y":13,"parents":[]},{"symbol":"M","children":[{"x":6,"y":14}],"x":6,"y":13,"parents":[]},{"symbol":"R","children":[{"x":3,"y":16}],"x":0,"y":14,"parents":[]},{"symbol":"R","children":[{"x":3,"y":16}],"x":2,"y":14,"parents":[]},{"symbol":"R","children":[{"x":3,"y":16}],"x":4,"y":14,"parents":[]},{"symbol":"R","children":[{"x":3,"y":16}],"x":5,"y":14,"parents":[]},{"symbol":"R","children":[{"x":3,"y":16}],"x":6,"y":14,"parents":[]}],"room_type":"MonsterRoom"}}'
ENTANGLED_STATE = '{"available_commands":["play","end","potion","key","click","wait","state"],"ready_for_command":true,"in_game":true,"game_state":{"screen_type":"NONE","screen_state":{},"seed":7230305506610474027,"combat_state":{"draw_pile":[{"exhausts":false,"is_playable":false,"cost":1,"name":"Headbutt","id":"Headbutt","type":"ATTACK","ethereal":false,"uuid":"3c93fe0d-657f-4618-ba86-745b6dd1ab50","upgrades":0,"rarity":"COMMON","has_target":true},{"exhausts":false,"is_playable":false,"cost":1,"name":"Strike","id":"Strike_R","type":"ATTACK","ethereal":false,"uuid":"35b891a8-b35c-48fd-9072-11b399f04437","upgrades":0,"rarity":"BASIC","has_target":true},{"exhausts":false,"is_playable":true,"cost":1,"name":"Defend","id":"Defend_R","type":"SKILL","ethereal":false,"uuid":"38cce5d0-b4e6-4312-bf8b-69a413093291","upgrades":0,"rarity":"BASIC","has_target":false},{"exhausts":false,"is_playable":false,"cost":1,"name":"Strike","id":"Strike_R","type":"ATTACK","ethereal":false,"uuid":"4df06365-d99e-43cd-a743-4935f05648af","upgrades":0,"rarity":"BASIC","has_target":true},{"exhausts":false,"is_playable":false,"cost":2,"name":"Bash","id":"Bash","type":"ATTACK","ethereal":false,"uuid":"0add998d-6571-4f08-b100-3629d9ad0b35","upgrades":0,"rarity":"BASIC","has_target":true},{"exhausts":false,"is_playable":true,"cost":1,"name":"Defend","id":"Defend_R","type":"SKILL","ethereal":false,"uuid":"301fadd9-f555-477f-8a50-28b3bf706024","upgrades":0,"rarity":"BASIC","has_target":false},{"exhausts":false,"is_playable":false,"cost":1,"name":"Strike","id":"Strike_R","type":"ATTACK","ethereal":false,"uuid":"f11ab94a-d9a8-4c00-9772-24fac4e8c5b9","upgrades":0,"rarity":"BASIC","has_target":true}],"discard_pile":[],"exhaust_pile":[],"cards_discarded_this_turn":0,"times_damaged":1,"monsters":[{"is_gone":false,"move_hits":1,"move_base_damage":13,"last_move_id":2,"half_dead":false,"move_adjusted_damage":13,"max_hp":46,"intent":"ATTACK","second_last_move_id":1,"move_id":1,"name":"Slaver","current_hp":16,"block":0,"id":"SlaverRed","powers":[{"amount":1,"just_applied":false,"name":"Vulnerable","id":"Vulnerable"}]}],"turn":3,"limbo":[],"hand":[{"exhausts":false,"is_playable":false,"cost":1,"name":"Pommel Strike","id":"Pommel Strike","type":"ATTACK","ethereal":false,"uuid":"8c310a44-43c0-4681-a8b5-b9d72d3dd09a","upgrades":0,"rarity":"COMMON","has_target":true},{"exhausts":false,"is_playable":false,"cost":1,"name":"Strike+","id":"Strike_R","type":"ATTACK","ethereal":false,"uuid":"7c33e798-7f55-4577-b87f-dd320cb9198d","upgrades":1,"rarity":"BASIC","has_target":true},{"exhausts":false,"is_playable":false,"cost":1,"name":"Strike","id":"Strike_R","type":"ATTACK","ethereal":false,"uuid":"ac619ed1-45e7-4809-aece-d4c4249d8270","upgrades":0,"rarity":"BASIC","has_target":true},{"exhausts":false,"is_playable":true,"cost":1,"name":"Defend","id":"Defend_R","type":"SKILL","ethereal":false,"uuid":"feb7cde9-1f9b-4e12-ab10-57f6a2ecef80","upgrades":0,"rarity":"BASIC","has_target":false},{"exhausts":false,"is_playable":true,"cost":1,"name":"Defend","id":"Defend_R","type":"SKILL","ethereal":false,"uuid":"9fe49549-cfc1-4299-824d-8e3dbc9c33b5","upgrades":0,"rarity":"BASIC","has_target":false}],"player":{"orbs":[],"current_hp":60,"block":0,"max_hp":80,"powers":[{"amount":1,"name":"Dark Embrace","id":"Dark Embrace"},{"amount":1,"name":"Entangled","id":"Entangled"}],"energy":3}},"deck":[{"exhausts":false,"is_playable":false,"cost":1,"name":"Strike+","id":"Strike_R","type":"ATTACK","ethereal":false,"uuid":"7c33e798-7f55-4577-b87f-dd320cb9198d","upgrades":1,"rarity":"BASIC","has_target":true},{"exhausts":false,"is_playable":false,"cost":1,"name":"Strike","id":"Strike_R","type":"ATTACK","ethereal":false,"uuid":"ac619ed1-45e7-4809-aece-d4c4249d8270","upgrades":0,"rarity":"BASIC","has_target":true},{"exhausts":false,"is_playable":false,"cost":1,"name":"Strike","id":"Strike_R","type":"ATTACK","ethereal":false,"uuid":"4df06365-d99e-43cd-a743-4935f05648af","upgrades":0,"rarity":"BASIC","has_target":true},{"exhausts":false,"is_playable":false,"cost":1,"name":"Strike","id":"Strike_R","type":"ATTACK","ethereal":false,"uuid":"f11ab94a-d9a8-4c00-9772-24fac4e8c5b9","upgrades":0,"rarity":"BASIC","has_target":true},{"exhausts":false,"is_playable":false,"cost":1,"name":"Strike","id":"Strike_R","type":"ATTACK","ethereal":false,"uuid":"35b891a8-b35c-48fd-9072-11b399f04437","upgrades":0,"rarity":"BASIC","has_target":true},{"exhausts":false,"is_playable":true,"cost":1,"name":"Defend","id":"Defend_R","type":"SKILL","ethereal":false,"uuid":"38cce5d0-b4e6-4312-bf8b-69a413093291","upgrades":0,"rarity":"BASIC","has_target":false},{"exhausts":false,"is_playable":true,"cost":1,"name":"Defend","id":"Defend_R","type":"SKILL","ethereal":false,"uuid":"301fadd9-f555-477f-8a50-28b3bf706024","upgrades":0,"rarity":"BASIC","has_target":false},{"exhausts":false,"is_playable":true,"cost":1,"name":"Defend","id":"Defend_R","type":"SKILL","ethereal":false,"uuid":"9fe49549-cfc1-4299-824d-8e3dbc9c33b5","upgrades":0,"rarity":"BASIC","has_target":false},{"exhausts":false,"is_playable":true,"cost":1,"name":"Defend","id":"Defend_R","type":"SKILL","ethereal":false,"uuid":"feb7cde9-1f9b-4e12-ab10-57f6a2ecef80","upgrades":0,"rarity":"BASIC","has_target":false},{"exhausts":false,"is_playable":false,"cost":2,"name":"Bash","id":"Bash","type":"ATTACK","ethereal":false,"uuid":"0add998d-6571-4f08-b100-3629d9ad0b35","upgrades":0,"rarity":"BASIC","has_target":true},{"exhausts":false,"is_playable":false,"cost":1,"name":"Pommel Strike","id":"Pommel Strike","type":"ATTACK","ethereal":false,"uuid":"8c310a44-43c0-4681-a8b5-b9d72d3dd09a","upgrades":0,"rarity":"COMMON","has_target":true},{"exhausts":false,"is_playable":true,"cost":2,"name":"Dark Embrace","id":"Dark Embrace","type":"POWER","ethereal":false,"uuid":"61b3b58d-48f6-4319-ac41-cab6c7d88ee2","upgrades":0,"rarity":"UNCOMMON","has_target":false},{"exhausts":false,"is_playable":false,"cost":1,"name":"Headbutt","id":"Headbutt","type":"ATTACK","ethereal":false,"uuid":"3c93fe0d-657f-4618-ba86-745b6dd1ab50","upgrades":0,"rarity":"COMMON","has_target":true}],"relics":[{"name":"Burning Blood","id":"Burning Blood","counter":-1}],"max_hp":80,"act_boss":"Slime Boss","gold":136,"action_phase":"WAITING_ON_USER","act":1,"screen_name":"NONE","room_phase":"COMBAT","is_screen_up":false,"potions":[{"requires_target":true,"can_use":true,"can_discard":true,"name":"Fire Potion","id":"Fire Potion"},{"requires_target":false,"can_use":true,"can_discard":true,"name":"Liquid Bronze","id":"LiquidBronze"},{"requires_target":false,"can_use":false,"can_discard":false,"name":"Potion Slot","id":"Potion Slot"}],"current_hp":60,"floor":4,"ascension_level":0,"class":"IRONCLAD","map":[{"symbol":"M","children":[{"x":0,"y":1}],"x":0,"y":0,"parents":[]},{"symbol":"M","children":[{"x":2,"y":1}],"x":1,"y":0,"parents":[]},{"symbol":"M","children":[{"x":3,"y":1}],"x":3,"y":0,"parents":[]},{"symbol":"M","children":[{"x":4,"y":1}],"x":4,"y":0,"parents":[]},{"symbol":"M","children":[{"x":6,"y":1}],"x":6,"y":0,"parents":[]},{"symbol":"M","children":[{"x":1,"y":2}],"x":0,"y":1,"parents":[]},{"symbol":"M","children":[{"x":1,"y":2}],"x":2,"y":1,"parents":[]},{"symbol":"M","children":[{"x":2,"y":2},{"x":4,"y":2}],"x":3,"y":1,"parents":[]},{"symbol":"?","children":[{"x":5,"y":2}],"x":4,"y":1,"parents":[]},{"symbol":"M","children":[{"x":6,"y":2}],"x":6,"y":1,"parents":[]},{"symbol":"M","children":[{"x":2,"y":3}],"x":1,"y":2,"parents":[]},{"symbol":"M","children":[{"x":2,"y":3}],"x":2,"y":2,"parents":[]},{"symbol":"?","children":[{"x":4,"y":3}],"x":4,"y":2,"parents":[]},{"symbol":"?","children":[{"x":5,"y":3}],"x":5,"y":2,"parents":[]},{"symbol":"?","children":[{"x":6,"y":3}],"x":6,"y":2,"parents":[]},{"symbol":"M","children":[{"x":3,"y":4}],"x":2,"y":3,"parents":[]},{"symbol":"M","children":[{"x":3,"y":4}],"x":4,"y":3,"parents":[]},{"symbol":"M","children":[{"x":4,"y":4}],"x":5,"y":3,"parents":[]},{"symbol":"M","children":[{"x":5,"y":4}],"x":6,"y":3,"parents":[]},{"symbol":"?","children":[{"x":3,"y":5},{"x":4,"y":5}],"x":3,"y":4,"parents":[]},{"symbol":"M","children":[{"x":4,"y":5}],"x":4,"y":4,"parents":[]},{"symbol":"M","children":[{"x":5,"y":5}],"x":5,"y":4,"parents":[]},{"symbol":"E","children":[{"x":3,"y":6}],"x":3,"y":5,"parents":[]},{"symbol":"R","children":[{"x":3,"y":6},{"x":5,"y":6}],"x":4,"y":5,"parents":[]},{"symbol":"R","children":[{"x":5,"y":6}],"x":5,"y":5,"parents":[]},{"symbol":"M","children":[{"x":2,"y":7},{"x":3,"y":7},{"x":4,"y":7}],"x":3,"y":6,"parents":[]},{"symbol":"E","children":[{"x":6,"y":7}],"x":5,"y":6,"parents":[]},{"symbol":"E","children":[{"x":2,"y":8}],"x":2,"y":7,"parents":[]},{"symbol":"M","children":[{"x":2,"y":8}],"x":3,"y":7,"parents":[]},{"symbol":"$","children":[{"x":5,"y":8}],"x":4,"y":7,"parents":[]},{"symbol":"M","children":[{"x":5,"y":8}],"x":6,"y":7,"parents":[]},{"symbol":"T","children":[{"x":2,"y":9}],"x":2,"y":8,"parents":[]},{"symbol":"T","children":[{"x":5,"y":9},{"x":6,"y":9}],"x":5,"y":8,"parents":[]},{"symbol":"?","children":[{"x":2,"y":10},{"x":3,"y":10}],"x":2,"y":9,"parents":[]},{"symbol":"M","children":[{"x":4,"y":10},{"x":5,"y":10}],"x":5,"y":9,"parents":[]},{"symbol":"?","children":[{"x":5,"y":10}],"x":6,"y":9,"parents":[]},{"symbol":"E","children":[{"x":2,"y":11}],"x":2,"y":10,"parents":[]},{"symbol":"R","children":[{"x":4,"y":11}],"x":3,"y":10,"parents":[]},{"symbol":"?","children":[{"x":4,"y":11},{"x":5,"y":11}],"x":4,"y":10,"parents":[]},{"symbol":"$","children":[{"x":6,"y":11}],"x":5,"y":10,"parents":[]},{"symbol":"M","children":[{"x":1,"y":12}],"x":2,"y":11,"parents":[]},{"symbol":"M","children":[{"x":3,"y":12},{"x":5,"y":12}],"x":4,"y":11,"parents":[]},{"symbol":"?","children":[{"x":5,"y":12}],"x":5,"y":11,"parents":[]},{"symbol":"M","children":[{"x":5,"y":12},{"x":6,"y":12}],"x":6,"y":11,"parents":[]},{"symbol":"$","children":[{"x":1,"y":13}],"x":1,"y":12,"parents":[]},{"symbol":"R","children":[{"x":3,"y":13}],"x":3,"y":12,"parents":[]},{"symbol":"M","children":[{"x":4,"y":13},{"x":5,"y":13}],"x":5,"y":12,"parents":[]},{"symbol":"R","children":[{"x":6,"y":13}],"x":6,"y":12,"parents":[]},{"symbol":"?","children":[{"x":1,"y":14}],"x":1,"y":13,"parents":[]},{"symbol":"?","children":[{"x":3,"y":14}],"x":3,"y":13,"parents":[]},{"symbol":"M","children":[{"x":3,"y":14},{"x":5,"y":14}],"x":4,"y":13,"parents":[]},{"symbol":"M","children":[{"x":5,"y":14}],"x":5,"y":13,"parents":[]},{"symbol":"M","children":[{"x":6,"y":14}],"x":6,"y":13,"parents":[]},{"symbol":"R","children":[{"x":3,"y":16}],"x":1,"y":14,"parents":[]},{"symbol":"R","children":[{"x":3,"y":16}],"x":3,"y":14,"parents":[]},{"symbol":"R","children":[{"x":3,"y":16}],"x":5,"y":14,"parents":[]},{"symbol":"R","children":[{"x":3,"y":16}],"x":6,"y":14,"parents":[]}],"room_type":"MonsterRoom"}}'


class TempFightHandlerTestCase(unittest.TestCase):
    def test_basics(self):
        handler = TempFightHandler()
        state = GameState(json.loads(STATE))

        self.assertEqual("play 1", handler.handle(state))

    def test_entagled(self):
        handler = TempFightHandler()
        state = GameState(json.loads(ENTANGLED_STATE))

        self.assertEqual("play 4", handler.handle(state))


if __name__ == '__main__':
    unittest.main()
